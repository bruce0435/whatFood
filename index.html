<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>吃什麼?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        font-family: 'Microsoft JhengHei', sans-serif;
        background: #f8f8f8;
        text-align: center;
        padding: 20px;
    }
    h1 {
        margin-top: 20px;
        font-size: 32px;
    }
    .tab {
        margin-top: 20px;
    }
    .tab button {
        padding: 10px 20px;
        font-size: 20px;
        margin: 5px;
        border: 2px solid #4CAF50;
        background-color: white;
        color: #4CAF50;
        cursor: pointer;
        border-radius: 8px;
    }
    .tab button:hover {
        background-color: #4CAF50;
        color: white;
    }
    #wheel, #settingsPage {
        margin-top: 20px;
    }
    #wheel {
        width: 600px;
        height: 80px;
        margin: 20px auto;
        border: 3px solid black;
        overflow: hidden;
        position: relative;
        font-size: 36px;
        font-weight: bold;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .item {
        height: 100%;
        line-height: 80px;
    }
    #startBtn, #saveBtn {
        margin: 20px 10px;
        padding: 10px 20px;
        font-size: 20px;
        border: 2px solid #4CAF50;
        background-color: white;
        color: #4CAF50;
        cursor: pointer;
        border-radius: 8px;
    }
    #startBtn:hover, #saveBtn:hover {
        background-color: #4CAF50;
        color: white;
    }
    #result {
        margin-top: 30px;
        font-size: 40px;
        font-weight: bold;
        color: #E91E63;
        display: none;
        transition: transform 0.3s ease;
    }
    #foodList {
        width: 300px;
        height: 200px;
        font-size: 18px;
    }

    /* 手機版微優化 */
    @media (max-width: 600px) {
        h1 {
            font-size: 24px;
        }
        .tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .tab button, #startBtn, #saveBtn {
            font-size: 18px;
            padding: 8px 16px;
            width: 80%;
            max-width: 250px;
        }
        #wheel {
            width: 90%;
            height: 60px;
            font-size: 24px;
        }
        #result {
            font-size: 28px;
        }
        #foodList {
            width: 90%;
            max-width: 400px;
            height: 150px;
            font-size: 16px;
        }
    }
</style>
</head>
<body>

<h1>吃什麼?</h1>
<div class="tab">
    <button onclick="showPage('wheelPage')">轉盤</button>
    <button onclick="showPage('settingsPage')">設定清單</button>
</div>

<div id="wheelPage">
    <div id="wheel">
        <div id="itemContainer"></div>
    </div>
    <button id="startBtn">開始</button>
    <div id="result"></div>
</div>

<div id="settingsPage" style="display: none;">
    <textarea id="foodList"></textarea><br>
    <button id="saveBtn">儲存清單</button>
</div>

<script>
    let foods = [];

    const itemContainer = document.getElementById('itemContainer');
    const result = document.getElementById('result');
    const foodList = document.getElementById('foodList');

    function showPage(page) {
        document.getElementById('wheelPage').style.display = page === 'wheelPage' ? 'block' : 'none';
        document.getElementById('settingsPage').style.display = page === 'settingsPage' ? 'block' : 'none';
    }

    function createItems() {
        itemContainer.innerHTML = '';
        const div = document.createElement('div');
        div.className = 'item';
        div.textContent = '準備抽選...';
        itemContainer.appendChild(div);
    }

    function loadFoods() {
        const storedFoods = localStorage.getItem('foods');
        if (storedFoods) {
            foods = JSON.parse(storedFoods);
        } else {
            foods = [
                '姊妹牛羊肉', '黃記辣脆腸', '小川家', '夜夜見來蛋包飯', 'Q禾豐邑',
                '徐大姊炸香香', '阿緣鹽酥雞香雞排', '味泉米糕', '忠孝夜市明哥滷味',
                '南台中肉員', '沙茶魷魚羹', '大碗公剉冰-忠孝店', '黃金蛋包飯（炒麵、燴飯）',
                '正老牌臭豆腐麵線糊', '桂香麻醬麵', '老夫子牛排', '嗑肉石鍋 （忠孝店）'
            ];
        }
        foodList.value = foods.join('\n');
    }

    function startSpin() {
        loadFoods();
        if (foods.length === 0) {
            alert('請先設定店家名稱！');
            return;
        }
        result.style.display = 'none';
        let elapsed = 0;
        let interval = 50;
        const totalDuration = 4000;
        const maxInterval = 300;

        const timer = setInterval(() => {
            const randomIndex = Math.floor(Math.random() * foods.length);
            itemContainer.innerHTML = `<div class="item">${foods[randomIndex]}</div>`;
            elapsed += interval;

            if (elapsed >= totalDuration) {
                clearInterval(timer);
                const finalFood = foods[randomIndex];
                result.textContent = `今天吃：${finalFood}`;
                result.style.display = 'block';
                result.style.transform = 'scale(1.5)';
                setTimeout(() => {
                    result.style.transform = 'scale(1)';
                }, 300);
            }
            if (interval < maxInterval) {
                interval += 10;
            }
        }, interval);
    }

    function saveFoods() {
        const lines = foodList.value.split('\n').map(line => line.trim()).filter(line => line);
        foods = lines;
        localStorage.setItem('foods', JSON.stringify(foods));
        alert('已儲存清單！');
    }

    document.getElementById('startBtn').addEventListener('click', startSpin);
    document.getElementById('saveBtn').addEventListener('click', saveFoods);

    createItems();
    loadFoods();
</script>

</body>
</html>
